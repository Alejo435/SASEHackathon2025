<!DOCTYPE html> 
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sunset Group Chat</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.6.1/socket.io.min.js"></script>
    <link rel="stylesheet" href="/static/messages.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>

<!-- Sunset timer -->
<div class="sunset-timer" id="sunsetTimer">
    Sunset in: --:--:--
</div>

<!-- Chat container; we will add a data-room attribute dynamically -->
<div class="chat-menu" id="messages" data-room="com1"></div>

<!-- Input area -->
<div class="input-area">
    <input id="messageInput" class="text-box" type="text" placeholder="Type a message..." />
    <input type="file" id="imageInput" accept="image/*" style="display:none">
    <button id="uploadBtn" class="send-btn">ðŸ“¤ Upload Img</button>
    <button class="send-btn" onclick="sendMessage()">Send</button>
</div>

<!-- Community tabs (can be reused on sidebar.html too) -->
<div class="sidebar-tabs">
    <div class="tab" data-room="com1">Community 1</div>
    <div class="tab" data-room="com2">Community 2</div>
    <div class="tab" data-room="com3">Community 3</div>
</div>

<script>
    // =================== Community Tab Switching ===================
    document.querySelectorAll('.tab[data-room]').forEach(tab => {
        tab.addEventListener('click', async () => {
            const room = tab.getAttribute('data-room');

            // Fetch the chat HTML for the selected community
            const response = await fetch(`/chat?room=${room}`);
            const html = await response.text();

            // Replace chat container with new content
            const chatContainer = document.getElementById('messages');
            chatContainer.innerHTML = html;
            chatContainer.setAttribute("data-room", room);

            // Re-initialize chat.js for the new container
            const script = document.createElement('script');
            script.src = "/static/chat.js";
            document.body.appendChild(script);
        });
    });
</script>

</body>
</html>